Running on device: cuda
Loading sloshing dataset...
Loading FNO model...
Model loaded successfully

============================================================
COLLECTING MAXIMUM ACTIVATION VALUES
============================================================
Registered hooks on 20 layers

Processing 100 samples...
  Processed 10/100 samples, current max: 1.092186e+00
  Processed 20/100 samples, current max: 1.092186e+00
  Processed 30/100 samples, current max: 1.092186e+00
  Processed 40/100 samples, current max: 1.092186e+00
  Processed 50/100 samples, current max: 1.092186e+00
  Processed 60/100 samples, current max: 1.092186e+00
  Processed 70/100 samples, current max: 1.117044e+00
  Processed 80/100 samples, current max: 1.117044e+00
  Processed 90/100 samples, current max: 1.136961e+00
  Processed 100/100 samples, current max: 1.136961e+00

Processed 100 samples

Global maximum activation value: 1.136961e+00

Results saved to: max_activation_value.json

Top 10 layers by maximum activation:
  1. lifting.fcs.0: 1.136961e+00
  2. fno_blocks.convs.1: 5.788667e-01
  3. fno_blocks.convs.0: 5.685226e-01
  4. fno_blocks.convs.2: 4.574878e-01
  5. lifting.fcs.1: 4.525018e-01
  6. fno_blocks.convs.3: 4.405355e-01
  7. fno_blocks.channel_mlp.1.fcs.0: 3.563739e-01
  8. fno_blocks.channel_mlp.0.fcs.0: 3.027639e-01
  9. fno_blocks.channel_mlp.2.fcs.1: 2.773750e-01
  10. fno_blocks.channel_mlp.1.fcs.1: 2.652859e-01

============================================================
MAX ACTIVATION COLLECTION COMPLETE
============================================================
